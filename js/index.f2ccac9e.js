(function(t){function o(o){for(var r,i,u=o[0],s=o[1],l=o[2],c=0,b=[];c<u.length;c++)i=u[c],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&b.push(a[i][0]),a[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);f&&f(o);while(b.length)b.shift()();return n.push.apply(n,l||[]),e()}function e(){for(var t,o=0;o<n.length;o++){for(var e=n[o],r=!0,i=1;i<e.length;i++){var s=e[i];0!==a[s]&&(r=!1)}r&&(n.splice(o--,1),t=u(u.s=e[0]))}return t}var r={},a={index:0},n=[];function i(t){return u.p+"js/"+({about:"about",author:"author",book:"book"}[t]||t)+"."+{about:"5a142fdc",author:"84d66617",book:"2519e340","chunk-2d0e95df":"9422947e"}[t]+".js"}function u(o){if(r[o])return r[o].exports;var e=r[o]={i:o,l:!1,exports:{}};return t[o].call(e.exports,e,e.exports,u),e.l=!0,e.exports}u.e=function(t){var o=[],e=a[t];if(0!==e)if(e)o.push(e[2]);else{var r=new Promise((function(o,r){e=a[t]=[o,r]}));o.push(e[2]=r);var n,s=document.createElement("script");s.charset="utf-8",s.timeout=120,u.nc&&s.setAttribute("nonce",u.nc),s.src=i(t);var l=new Error;n=function(o){s.onerror=s.onload=null,clearTimeout(c);var e=a[t];if(0!==e){if(e){var r=o&&("load"===o.type?"missing":o.type),n=o&&o.target&&o.target.src;l.message="Loading chunk "+t+" failed.\n("+r+": "+n+")",l.name="ChunkLoadError",l.type=r,l.request=n,e[1](l)}a[t]=void 0}};var c=setTimeout((function(){n({type:"timeout",target:s})}),12e4);s.onerror=s.onload=n,document.head.appendChild(s)}return Promise.all(o)},u.m=t,u.c=r,u.d=function(t,o,e){u.o(t,o)||Object.defineProperty(t,o,{enumerable:!0,get:e})},u.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u.t=function(t,o){if(1&o&&(t=u(t)),8&o)return t;if(4&o&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(u.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&o&&"string"!=typeof t)for(var r in t)u.d(e,r,function(o){return t[o]}.bind(null,r));return e},u.n=function(t){var o=t&&t.__esModule?function(){return t["default"]}:function(){return t};return u.d(o,"a",o),o},u.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},u.p="/",u.oe=function(t){throw console.error(t),t};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=o,s=s.slice();for(var c=0;c<s.length;c++)o(s[c]);var f=l;n.push([0,"chunk-vendors"]),e()})({0:function(t,o,e){t.exports=e("56d7")},3019:function(t){t.exports=JSON.parse('{"authors":[{"id":1,"name":"Лев Толстой","birthdate":"1828-09-09","gender":"Mужской","country":"Россия"}],"books":[{"id":1,"isbn":"12345","title":"Война и Мир","authors":[1],"photo":"https://a.wattpad.com/cover/64517639-352-k806859.jpg","desc":"История войны и мира в разнообразных и неожиданных проявлениях, пронизанная множеством сюжетных линий, - это пронзительный, точный, панорамный и обстоятельный взгляд мудрого художника на вечные проблемы Бытия.","tags":["война","классика","мир","роман","толстой"],"price":0,"category":"Классика"}]}')},"56d7":function(t,o,e){"use strict";e.r(o);e("e260"),e("e6cf"),e("cca6"),e("a79d");var r=e("2b0e"),a=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{attrs:{id:"app"}},[e("NavBar"),e("router-view")],1)},n=[],i=e("5530"),u=function(){var t=this,o=t.$createElement,r=t._self._c||o;return r("b-navbar",{attrs:{toggleable:"lg",type:"light",variant:"faded"}},[r("b-navbar-brand",{attrs:{href:"/"}},[r("img",{attrs:{height:"60px",src:e("cf05")}}),t._v(" Bookmate ")]),r("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),r("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[r("b-navbar-nav",[r("b-nav-item",{attrs:{to:"/"}},[r("b-icon-house-fill")],1),r("b-nav-item",{attrs:{to:"/books"}},[t._v("Книги")]),r("b-nav-item",{attrs:{to:"/authors"}},[t._v("Авторы")])],1),r("b-navbar-nav",{staticClass:"ml-auto"},[r("b-nav-item",{attrs:{to:"/about"}},[t._v("О проекте")])],1)],1)],1)},s=[],l={name:"NavBar"},c=l,f=e("2877"),b=Object(f["a"])(c,u,s,!1,null,"7d156367",null),h=b.exports,m=e("2f62"),d={name:"App",components:{NavBar:h},data:function(){return{}},created:function(){this.init()},methods:Object(i["a"])({},Object(m["c"])({init:"init"}))},p=d,k=Object(f["a"])(p,a,n,!1,null,null,null),v=k.exports,g=e("5f5b"),y=e("b1e0"),S=(e("f9e3"),e("2dd8"),e("d3b7"),e("8c4f")),O=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"home"},[e("b-container",{attrs:{fluid:""}},[e("b-tabs",{attrs:{"content-class":"mt-3"}},[e("b-tab",{attrs:{active:"",title:"Книги"}},[e("BookList")],1),e("b-tab",{attrs:{title:"Авторы"}},[e("AuthorList")],1)],1)],1)],1)},_=[],x=e("eda0"),B=e("b7f0"),$={name:"Home",components:{BookList:x["default"],AuthorList:B["a"]}},A=$,w=Object(f["a"])(A,O,_,!1,null,null,null),j=w.exports;r["default"].use(S["a"]);var T=[{path:"/",name:"Home",component:j},{path:"/about",name:"About",component:function(){return e.e("about").then(e.bind(null,"f820"))}},{path:"/authors",name:"Authors",component:function(){return e.e("author").then(e.bind(null,"adc6"))}},{path:"/author/:author_id",name:"Author",props:!0,alias:"/a",component:function(){return e.e("author").then(e.bind(null,"9411"))},children:[{path:"",component:function(){return e.e("author").then(e.bind(null,"eda0"))},props:!0}]},{path:"/books",name:"Books",component:function(){return e.e("book").then(e.bind(null,"4de9"))}},{path:"/book/:book_id",name:"Book",component:function(){return e.e("book").then(e.bind(null,"8bf3"))}},{path:"*",component:function(){return e.e("chunk-2d0e95df").then(e.bind(null,"8cdb"))}}],P=new S["a"]({mode:"history",base:"/",routes:T});P.beforeEach((function(t,o,e){window.scrollTo(0,0),e()}));var R=P,I=e("3019");r["default"].use(m["a"]);var N=new m["a"].Store({state:{authors:[],books:[]},mutations:{init:function(t){if(localStorage.getItem("authors"))try{t.authors=JSON.parse(localStorage.getItem("authors"))}catch(o){localStorage.removeItem("authors")}else t.authors=I.authors;if(localStorage.getItem("books"))try{t.books=JSON.parse(localStorage.getItem("books"))}catch(o){localStorage.removeItem("books")}else t.books=I.books},saveBooks:function(t,o){t.books=o;var e=JSON.stringify(o);localStorage.setItem("books",e)},saveAuthors:function(t,o){t.authors=o;var e=JSON.stringify(o);localStorage.setItem("authors",e)}},actions:{updateBooks:function(t,o){var e=t.commit;e("saveBooks",o.books)},updateAuthors:function(t,o){var e=t.commit;e("saveAuthors",o.authors)}},getters:{AUTHORS:function(t){return t.authors},BOOKS:function(t){return t.books}},modules:{}});r["default"].use(g["a"]),r["default"].use(y["a"]),r["default"].config.productionTip=!1,new r["default"]({router:R,store:N,render:function(t){return t(v)}}).$mount("#app")},b7f0:function(t,o,e){"use strict";var r=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",[e("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-author",modifiers:{"modal-author":!0}}]},[t._v("Добавить Автора")]),e("b-modal",{ref:"modal-author",attrs:{id:"modal-author","hide-footer":"",title:"Новый Автор"}},[e("AuthorForm",{on:{"update:author":function(o){return t.addAuthor(o)}}})],1),e("b-table",{attrs:{fields:t.authorfields,items:t.authors,striped:""},scopedSlots:t._u([{key:"cell(name)",fn:function(o){return[e("b-link",{attrs:{to:"/author/"+o.item.id}},[t._v(t._s(o.value))])]}}])})],1)},a=[],n=e("5530"),i=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",[e("b-form",{ref:"authorform",on:{reset:t.onResetAuthor,submit:function(o){return o.stopPropagation(),o.preventDefault(),t.handleSubmitAuthor(o)}}},[e("b-form-group",{attrs:{id:"authorform-input-group-fio",state:t.nameState,autofocus:"","invalid-feedback":"Укажите ФИО",label:"ФИО:","label-for":"authorform-input-fio",trim:""}},[e("b-form-input",{attrs:{id:"authorform-input-fio",state:t.nameState,placeholder:"Введите ФИО",required:""},model:{value:t.authorform.name,callback:function(o){t.$set(t.authorform,"name",o)},expression:"authorform.name"}})],1),e("b-form-group",{attrs:{id:"authorform-input-group-birthdate",label:"Дата рождения:","label-for":"authorform-input-birthdate"}},[e("b-form-datepicker",{staticClass:"mb-2",attrs:{id:"authorform-input-birthdate","date-format-options":{day:"numeric",month:"numeric",year:"numeric"},local:"ru",placeholder:"Дата не выбрана",required:""},model:{value:t.authorform.birthdate,callback:function(o){t.$set(t.authorform,"birthdate",o)},expression:"authorform.birthdate"}})],1),e("b-form-group",{attrs:{id:"authorform-input-group-gender",label:"Пол:","label-for":"authorform-input-gender"}},[e("b-form-select",{attrs:{id:"authorform-input-gender",options:t.gender,required:""},model:{value:t.authorform.gender,callback:function(o){t.$set(t.authorform,"gender",o)},expression:"authorform.gender"}})],1),e("b-form-group",{attrs:{id:"authorform-input-group-country",label:"Страна:","label-for":"authorform-input-country"}},[e("b-form-select",{attrs:{id:"authorform-input-country",options:t.country,required:""},model:{value:t.authorform.country,callback:function(o){t.$set(t.authorform,"country",o)},expression:"authorform.country"}})],1),e("b-button",{attrs:{type:"submit",variant:"primary"}},[t._v("Сохранить")]),e("b-button",{attrs:{type:"reset",variant:"danger"}},[t._v("Очистить")])],1)],1)},u=[],s=(e("b0c0"),{name:"Author",components:{},data:function(){return{authorform:{name:"",birthdate:null,gender:null,country:null},gender:[{text:"Укажите пол",value:null},"Мужской","Женский"],country:[{text:"Укажите страну",value:null},"Россия","Украина","Беларусь"]}},computed:{nameState:function(){return this.authorform.name.length>2}},methods:{checkFormValidity:function(){var t=this.$refs.authorform.checkValidity();return t},handleSubmitAuthor:function(){var t=this;this.checkFormValidity()&&(this.$emit("update:author",this.authorform),this.$nextTick((function(){t.$bvModal.hide("modal-author")})))},onResetAuthor:function(t){t.preventDefault(),this.authorform.name="",this.authorform.birthdate=null,this.authorform.gender=null,this.authorform.country=null}}}),l=s,c=e("2877"),f=Object(c["a"])(l,i,u,!1,null,null,null),b=f.exports,h=e("3019"),m=e("2f62"),d={name:"AuthorList",components:{AuthorForm:b},data:function(){return{authorfields:[{key:"name",label:"ФИО",sortable:!0},{key:"birthdate",label:"Дата рождения"},{key:"gender",label:"Пол"},{key:"country",label:"Страна",sortable:!0}],authors:h.authors}},computed:Object(n["a"])({},Object(m["b"])(["BOOKS","AUTHORS"])),methods:{addAuthor:function(t){var o=this;t.id=this.authors.length+1,this.authors.push(t),this.$store.dispatch("updateAuthors",{authors:this.authors}).then((function(){console.log("Success")})).catch((function(t){o.error="Не удалось добавить автора",console.log(t)}))}},mounted:function(){this.authors=this.AUTHORS}},p=d,k=Object(c["a"])(p,r,a,!1,null,null,null);o["a"]=k.exports},cf05:function(t,o,e){t.exports=e.p+"img/logo.bd47a9c6.png"},eda0:function(t,o,e){"use strict";e.r(o);var r=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",[e("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-book",modifiers:{"modal-book":!0}}]},[t._v("Добавить книгу")]),e("b-form-group",{staticClass:"mb-0",attrs:{label:"Фильтр","label-align-sm":"right","label-cols-sm":"3","label-for":"filterInput","label-size":"sm"}},[e("b-form-input",{attrs:{id:"filterInput",placeholder:"Поиск на названию и описанию ...",type:"search"},model:{value:t.filter,callback:function(o){t.filter=o},expression:"filter"}})],1),e("b-modal",{ref:"modal-book",attrs:{id:"modal-book","hide-footer":"",title:"Новая Книга"}},[e("BookForm",{on:{"update:book":function(o){return t.addBook(o)}}})],1),e("b-table",{attrs:{id:"booklist","current-page":t.currentPage,fields:t.bookfields,filter:t.filter,filterIncludedFields:t.filterOn,items:t.books,"per-page":t.perPage,striped:""},on:{filtered:t.onFiltered},scopedSlots:t._u([{key:"cell(id)",fn:function(o){return[e("b-button",{on:{click:function(e){return t.showConfirmBox(o.value)}}},[t._v("X")])]}},{key:"cell(title)",fn:function(o){return[e("b-link",{attrs:{to:"/book/"+o.item.id}},[t._v(t._s(o.value))])]}},{key:"cell(photo)",fn:function(t){return[e("b-img",{attrs:{alt:"Обложка книги: "+t.item.title,src:t.value,fluid:""}})]}},{key:"cell(authors)",fn:function(o){return t._l(o.value,(function(o){return e("span",{key:o.id},t._l(t.authorslist,(function(r){return e("span",{key:r.id},[r.value===o?e("span",[e("b-link",{attrs:{to:"/author/"+r.value}},[t._v(t._s(r.text))]),e("br")],1):t._e()])})),0)}))}},{key:"cell(tags)",fn:function(o){return t._l(o.value,(function(o){return e("span",{key:o.id},[e("b-badge",{attrs:{pill:"",variant:"secondary"}},[t._v(t._s(o))])],1)}))}},{key:"cell()",fn:function(o){return[e("i",[t._v(t._s(o.value))])]}}])}),e("b-pagination",{attrs:{"per-page":t.perPage,"total-rows":t.totalRows,align:"center","aria-controls":"booklist",small:""},model:{value:t.currentPage,callback:function(o){t.currentPage=o},expression:"currentPage"}})],1)},a=[],n=(e("caad"),e("a434"),e("b0c0"),e("2532"),e("5530")),i=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",[e("b-form",{ref:"bookform",on:{reset:t.onResetBook,submit:function(o){return o.stopPropagation(),o.preventDefault(),t.handleSubmitBook(o)}}},[e("b-form-group",{attrs:{id:"bookform-input-group-title",state:t.titleState,label:"Название:","label-for":"bookform-input-title"}},[e("b-form-input",{attrs:{id:"bookform-input-title",state:t.titleState,autofocus:"",placeholder:"Укажите название",required:"",trim:""},model:{value:t.bookform.title,callback:function(o){t.$set(t.bookform,"title",o)},expression:"bookform.title"}})],1),e("b-form-group",{attrs:{id:"bookform-input-group-isbn",state:t.isbnState,label:"ISBN:","label-for":"bookform-input-isbn"}},[e("b-form-input",{attrs:{id:"bookform-input-isbn",state:t.isbnState,placeholder:"Укажите ISBN",required:"",trim:""},model:{value:t.bookform.isbn,callback:function(o){t.$set(t.bookform,"isbn",o)},expression:"bookform.isbn"}})],1),e("b-form-group",{attrs:{id:"bookform-input-group-authors",label:"Автор(ы):","label-for":"bookform-input-authors"}},[e("b-form-select",{attrs:{id:"bookform-input-authors",options:t.optionsauthors,multiple:"",required:""},model:{value:t.bookform.authors,callback:function(o){t.$set(t.bookform,"authors",o)},expression:"bookform.authors"}})],1),e("b-form-group",{attrs:{id:"bookform-input-group-photo",label:"Обложка:","label-for":"bookform-input-photo"}},[e("b-form-input",{attrs:{id:"bookform-input-photo",pattern:"https?://.+",placeholder:"Укажите URL для фото обложки (http://)",required:"",size:"30",trim:"",type:"url"},model:{value:t.bookform.photo,callback:function(o){t.$set(t.bookform,"photo",o)},expression:"bookform.photo"}})],1),e("b-form-group",{attrs:{id:"bookform-input-group-desc",label:"Описание:","label-for":"bookform-input-desc"}},[e("b-form-textarea",{attrs:{id:"bookform-input-desc","max-rows":"6",placeholder:"Краткое описание книги",required:"",rows:"3",size:"sm",trim:""},model:{value:t.bookform.desc,callback:function(o){t.$set(t.bookform,"desc",o)},expression:"bookform.desc"}})],1),e("b-form-group",{attrs:{id:"bookform-input-group-price",label:"Цена:","label-for":"bookform-input-price"}},[e("b-form-input",{attrs:{id:"bookform-input-price",max:"1000000.00",min:"0.00",placeholder:"Укажите цену",required:"",step:"0.01",type:"number"},model:{value:t.bookform.price,callback:function(o){t.$set(t.bookform,"price",o)},expression:"bookform.price"}})],1),e("b-form-group",{attrs:{id:"bookform-input-group-category",label:"Категории:","label-for":"bookform-input-category"}},[e("b-form-select",{attrs:{id:"bookform-input-category",options:t.optionscategory,required:""},model:{value:t.bookform.category,callback:function(o){t.$set(t.bookform,"category",o)},expression:"bookform.category"}})],1),e("b-form-group",{attrs:{id:"bookform-input-group-tags",label:"Тэги:","label-for":"bookform-input-tags"}},[e("b-form-tags",{attrs:{id:"bookform-input-tags","add-button-text":"+",placeholder:"Укажите тэги","tag-pills":""},model:{value:t.bookform.tags,callback:function(o){t.$set(t.bookform,"tags",o)},expression:"bookform.tags"}})],1),e("b-button",{attrs:{type:"submit",variant:"primary"}},[t._v("Сохранить")]),e("b-button",{attrs:{type:"reset",variant:"danger"}},[t._v("Очистить")])],1)],1)},u=[],s=e("2f62"),l={name:"Book",components:{},data:function(){return{bookform:{title:"",isbn:"",authors:[],photo:"",desc:"",tags:[],price:0,category:null},optionsauthors:[],optionscategory:[{text:"Укажите категорию",value:null},"Классика","Детективы","Фантастика"]}},computed:Object(n["a"])({titleState:function(){return this.bookform.title.length>2},isbnState:function(){return this.bookform.isbn.length>2}},Object(s["b"])(["AUTHORS"])),mounted:function(){for(var t in this.AUTHORS)this.optionsauthors.push({text:this.AUTHORS[t].name,value:this.AUTHORS[t].id})},methods:{checkFormValidity:function(){var t=this.$refs.bookform.checkValidity();return t},handleSubmitBook:function(){var t=this;this.checkFormValidity()&&(this.$emit("update:book",this.bookform),this.$nextTick((function(){t.$bvModal.hide("modal-book")})))},onResetBook:function(t){t.preventDefault(),this.bookform.title="",this.bookform.isbn="",this.bookform.authors=[],this.bookform.photo="",this.bookform.descr="",this.bookform.tags=[],this.bookform.price=0,this.bookform.category=null}}},c=l,f=e("2877"),b=Object(f["a"])(c,i,u,!1,null,null,null),h=b.exports,m={name:"BookList",props:{author_id:String},components:{BookForm:h},data:function(){return{bookfields:[{key:"isbn",label:"ISBN"},{key:"title",label:"Название",sortable:!0},{key:"authors",label:"Автор(ы)"},{key:"photo",label:"Обложка"},{key:"desc",label:"Описание"},{key:"tags",label:"Тэги"},{key:"price",label:"Цена",sortable:!0},{key:"category",label:"Категория"},{key:"id",label:"Действия"}],books:[],authorslist:[],totalRows:0,currentPage:1,perPage:5,filter:null,filterOn:["title","desc"]}},computed:Object(n["a"])({},Object(s["b"])(["BOOKS","AUTHORS"])),watch:{$route:function(t,o){o.params.author_id!=t.params.author_id&&this.reinit()}},mounted:function(){for(var t in this.reinit(),this.AUTHORS)this.authorslist.push({text:this.AUTHORS[t].name,value:this.AUTHORS[t].id})},methods:{reinit:function(){if(this.books=[],this.author_id>0)for(var t in this.BOOKS)this.BOOKS[t].authors.includes(parseInt(this.author_id))&&this.books.push(this.BOOKS[t]);else this.books=this.BOOKS},getBookNameById:function(t){for(var o in this.books)if(this.books[o].id===t)return this.books[o].title;return""},addBook:function(t){var o=this;t.id=this.books.length+1,this.books.push(t),this.$store.dispatch("updateBooks",{books:this.books}).then((function(){console.log("Success")})).catch((function(t){o.error="Не удалось добавить книгу",console.log(t)}))},delBook:function(t){var o=this;for(var e in this.books)this.books[e].id===t&&(this.book=this.books.splice(e,1));this.$store.dispatch("updateBooks",{books:this.books}).then((function(){console.log("Success")})).catch((function(t){o.error="Не удалось удалить книгу",console.log(t)}))},showConfirmBox:function(t){var o=this;this.$bvModal.msgBoxConfirm('Удалить книгу "'+this.getBookNameById(t)+'" ?',{title:"Подтвердите удаление",okTitle:"Да",cancelTitle:"Нет"}).then((function(e){e&&o.delBook(t)}))},onFiltered:function(t){this.totalRows=t.length,this.currentPage=1}}},d=m,p=Object(f["a"])(d,r,a,!1,null,null,null);o["default"]=p.exports}});